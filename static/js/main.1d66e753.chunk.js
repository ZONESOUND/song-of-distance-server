(this["webpackJsonpgps-react"]=this["webpackJsonpgps-react"]||[]).push([[0],{101:function(t,e,n){},102:function(t,e,n){"use strict";n.r(e);var a=n(2),o=n.n(a),r=n(42),i=n.n(r),c=(n(52),n(10)),s=n(11),l=n(13),h=n(12),p=n(14),u=n(20),d=n(43),f=n.n(d),g=n(44),m=n.n(g)()("https://gps-250305.appspot.com"),v=!1;m.on("connect",(function(){v=!0,console.log("socket connect to server")}));var b,w,y,O,S=function(t,e){m.emit("osc",{address:t,args:[{value:e}]})},k=n(3),x=n.n(k),M=n(26),j=n.n(M),P=n(45),C=n.n(P),D=(x.a.Frequency("F3").toFrequency(),9),E={},I={},F=function(){var t=new x.a.Limiter(-.5).toMaster();(w=new x.a.Compressor(-30,3).connect(t)).ratio.value=20,(b=new x.a.Reverb({pre_delay:.05,decay:5,wet:.6}).connect(w)).generate(),(O=new x.a.Filter(6e3,"lowpass")).rolloff=-12,O.connect(b),L(),console.log("sample here",j.a),y=new x.a.Sampler({C3:j.a},(function(){console.log("sample load!"),y.attack=.25})).connect(O),new x.a.Sampler({C2:C.a},(function(){console.log("short sample load!")})).connect(O)},L=function(){for(var t=0;t<D;t++)N(t),I[t]=!1},N=function(t){E[t]=new x.a.Synth({oscillator:{type:"sine"},envelope:{attack:.1,decay:5,sustain:.15,release:.5}}),E[t].envelope.decayCurve="exponential"};function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function A(t){var e=0,n=0,a=[],o=[],r={},i=!0,c=0,s=[];t.setup=function(){t.createCanvas(t.windowWidth,t.windowHeight),t.frameRate(30),console.log("issocketConnect:"+v),F()},t.windowResized=function(){t.resizeCanvas(t.windowWidth,t.windowHeight)},t.myCustomRedrawAccordingToNewPropsHandler=function(t){t.configData&&(r=t.configData,p()),t.dataPoint&&0!==Object.keys(r).length&&((a=t.dataPoint).forEach((function(t){t||console.log("sth wrong?")})),h())};var l=function(e){var n=function(t,e,n){if(n.lon&&n.lat){var a=(n.lon-e.lon)*e.globalScale,o=(n.lat-e.lat)*e.globalScale,r=t.createVector(a,o);return r.x=(r.x>0?1:-1)*Math.pow(Math.abs(r.x),e.globalPow),r.y=(r.y>0?1:-1)*Math.pow(Math.abs(r.y),e.globalPow),r.y*=-1,r}return null}(t,r,e),a=1*n.mag().toFixed(5),o=1*(n.heading()/Math.PI*180).toFixed(5);return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(n,!0).forEach((function(e){Object(u.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{pos:n,dist:a,degree:o})},h=function(){var e=t.int(t.frameCount/4);e&&(o=a.slice(-e).map(l).filter((function(t){return t.dist<r.maxLineLength}))),i=!(e>a.length)},p=function(){for(var t=0;t<50;t++)s[t]=_(t,r.globalScale,r.globalPow)};t.draw=function(){var a,l;t.frameCount%25===0&&i&&h(),n=e,a=r.radioSpeed,l=t.frameCount,e=a*l/60%(2*Math.PI)-Math.PI,t.frameCount%10===0&&S("/gps/radio",1*(e/Math.PI*180).toFixed(5)),c++,t.background(255/c,100),t.textSize(12),t.fill(255),t.stroke(255,10),t.strokeWeight(1);var p="Total Nodes: ".concat(function(t){return t.length}(o),"\nActive: ").concat(function(t){return t.filter((function(t){return!t.leave})).length}(o),"\nExecute Time: ").concat(t.frameCount,"\nScanning: ").concat((e/Math.PI*180).toFixed(2),"\xb0");!function(t,e){t.push(),t.fill(255),t.textSize(14),t.textLeading(24),t.text(new Date,20,t.height-35),t.pop(),t.push(),t.fill(255,130),t.text(e,20,35),t.pop()}(t,p),t.translate(t.width/2,t.height/2),function(t,e){var n=t.frameCount;t.noFill();for(var a=0;a<50;a++){var o=0;if(e.length>a&&(o=e[a]),t.stroke(255,Math.max(60-a/10*60,4)+4*Math.sin(-n/10+a)),a<9){t.fill(255,255,255,1+1*t.noise(n/10,a)),t.stroke(255,20),t.beginShape(t.LINES);for(var r=0;r<360;r++){var i=R(o,n,a,r,50/(10-a));t.vertex(i*Math.cos(t.radians(r+n/40)),i*Math.sin(t.radians(r+n/40)))}t.endShape(),t.noStroke(),t.beginShape();for(var c=0;c<360;c++){var s=R(o,n,a,c,30/(8-a));t.vertex(s*Math.cos(t.radians(c+n/40)),s*Math.sin(t.radians(c+n/40)))}t.endShape(t.CLOSE)}else t.noFill(),t.ellipse(0,0,o,o)}}(t,s),function(t,e,n,a,o){var r;t.textSize(12),t.fill(255),t.stroke(255,10),t.strokeWeight(1),e.forEach((function(e,o){var i,c=Date.now()-e.timeStamp,s=e.pos.heading(),l=e.showId;if(e.pos){i=s-n;var h=(a-s)*(n-s)<=0&&Math.abs(a-n)<1;if(h){if(r!==e){var p=JSON.stringify({degree:e.degree,dist:e.dist,id:e.key,data:e.data,leave:e.leave,timeStamp:e.timeStamp,time_to_now_second:c});S("/gps/trigger",p)}r=e}t.push();var u=e.pos.mag();if(u<2*t.width){t.noFill(),t.beginShape();for(var d=0;d<u-10;d+=2){var f=s+t.noise(t.frameCount/10+d/10)/60;t.vertex(Math.cos(f)*d,Math.sin(f)*d)}t.endShape()}t.pop();var g=Math.abs(i%(2*Math.PI))<.08&&i<0;g&&(t.push(),t.fill(0,0,0,70),t.noStroke(),t.rect(e.pos.x+6,e.pos.y-5,t.textWidth(l)+8,12),t.fill(255),t.text(l,e.pos.x+10,e.pos.y+5),t.pop()),h?t.fill(255):t.fill(255,5+150/Math.log(c)+(g?50:0));var m=5+(i<0?Math.max(Math.min(-1/i,6),0):0)+2*t.noise(o,t.frameCount,e.lon);e.leave||(t.fill(255,0,0),m=5+2*Math.sin(t.frameCount/10),t.push(),t.stroke(255,200),t.rectMode(t.CENTER),t.translate(e.pos.x,e.pos.y),t.rotate(t.frameCount/(10+e.lon/100)),t.noFill(),t.rect(0,0,12,12),t.pop(),t.text("//ACTIVE ".concat(t.frameCount%10<5?".":"","\nID: ").concat(l),e.pos.x+10,e.pos.y+20)),t.ellipse(e.pos.x,e.pos.y,m,m)}else console.log("no position?")}))}(t,o,e,n),t.noFill(),function(t,e){t.push(),t.stroke(255,200),t.strokeWeight(2),t.line(0,0,1e3*Math.cos(e),1e3*Math.sin(e)),t.noStroke();for(var n=0;n<20;n++)t.fill(255,2.5*(20-n)),t.beginShape(),t.vertex(0,0),t.vertex(1e3*Math.cos(e-.02*(n-1)),1e3*Math.sin(e-.02*(n-1))),t.vertex(1e3*Math.cos(e-.02*n),1e3*Math.sin(e-.02*n)),t.endShape(t.CLOSE);t.pop()}(t,e),function(t,e){t.push(),t.fill("#f24"),t.noStroke(),t.ellipse(0,0,8,8),t.rectMode(t.CENTER),t.stroke(255),t.noFill(),t.strokeWeight(2),t.rect(0,0,20,20),t.rotate(t.frameCount/100),t.stroke(255,20),t.rect(0,0,20,20),t.pop(),t.push(),t.fill(255,200),t.text(e,20,12),t.pop()}(t,r.centerName),function(t){t.push(),t.stroke(255,255),t.strokeWeight(10),t.rect(-t.width/2,-t.height/2,t.width,t.height),t.strokeWeight(1),t.stroke(255,30),t.rect(-t.width/2+10,-t.height/2+10,t.width-20,t.height-20),t.stroke(255,255),t.strokeWeight(2),t.line(-t.width/2,0,-t.width/2+20,0),t.line(t.width/2,0,t.width/2-20,0),t.line(0,-t.height/2,0,-t.height/2+20),t.line(0,t.height/2,0,t.height/2-20),t.noStroke(),t.fill(255,200),t.textAlign(t.CENTER),t.text("W",-t.width/2+20+15,5),t.text("E",t.width/2-20-15,5),t.text("N",0,-t.height/2+20+20),t.text("S",0,t.height/2-20-10),t.pop()}(t),function(t){var e=(new Date).getSeconds();t.fill(255),t.rect(-t.width/2+e%5*30+20,t.height/2-75,25,6),t.stroke(255),t.noFill(),t.rect(-t.width/2+(e+1)%5*30+20,t.height/2-75,25,6)}(t)}}function _(t,e,n){return.5*Math.pow(Math.abs(t*e/10),n)}function R(t,e,n,a,o){return t/2+Math.sin(e/(10+10*n)+a/360*2*Math.PI*10)*o}var z=n(27);z.initializeApp({apiKey:"AIzaSyAldF3HRwUKCpzSid5MFtEEakwNYg12M6I",authDomain:"song-of-distance-47ab8.firebaseapp.com",databaseURL:"https://song-of-distance-47ab8.firebaseio.com",projectId:"song-of-distance-47ab8",storageBucket:"song-of-distance-47ab8.appspot.com",messagingSenderId:"807349511024",appId:"1:807349511024:web:bfabe2b53857e837d665b5",measurementId:"G-6D96Y0D4KW"});var T=z.database().ref().child("earthlocations"),J=n(46);function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(n,!0).forEach((function(e){Object(u.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var G=function(t){function e(){var t,n;Object(c.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(o)))).state={gp:{},gpsPermission:null,first:!0,key:null,allLocations:[],dataPoint:[]},n.updateDataSet=function(t){n.checkData(t),n.setState({allLocations:t,dataPoint:Object.entries(t).map((function(t){return U({},t[1],{key:t[0]})}))})},n.checkData=function(t){Object.entries(t).forEach((function(t){("key"in t[1]||T.child(t[0]).child("key").set(t[0]),"showId"in t[1]&&t[1].showId||!t[0]||T.child(t[0]).child("showId").set(q(t[0])),t[1].timeStamp&&t[1].lat&&t[1].lon)?Date.now()-t[1].timeStamp>6e3&&(t[1].leave||T.child(t[0]).child("leave").set(!0)):T.child(t[0]).remove()}))},n}return Object(p.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){var t=this;setInterval((function(){t.checkData(t.state.allLocations)}),1e4),T.on("value",(function(e){t.updateDataSet(e.val())}))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{dataPoint:this.state.dataPoint}))}}]),e}(a.Component),K=function(t){function e(){var t,n;Object(c.a)(this,e);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(o)))).state={data:{globalScale:25e4,globalPow:.58,maxLineLength:100,radioSpeed:.25*Math.PI,lat:23.87,lon:120.58,centerName:"center"},GUI:new J.a},n.saveControlData=function(){var t=n.state.data;sessionStorage.setItem("controlData",JSON.stringify(U({},t)))},n}return Object(p.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){var t=sessionStorage.getItem("controlData");console.log(t);var e=this.state,n=e.data,a=e.GUI;t&&(n=JSON.parse(t),this.setState({data:n}));var o={"add config":this.saveControlData};a.add(n,"globalScale",1e3,8e5),a.add(n,"globalPow",0,.99),a.add(n,"maxLineLength"),a.add(n,"radioSpeed",0,3,.01),a.add(n,"centerName"),a.add(n,"lat",-90,90,.01),a.add(n,"lon",-180,180,.01),a.add(o,"add config"),a.close()}},{key:"render",value:function(){var t=this.state.data,e=this.props.dataPoint;return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{sketch:A,dataPoint:e,configData:t}))}}]),e}(a.Component),q=function(t){return"A"+t.split("").map((function(t){return t.charCodeAt(0)})).reduce((function(t,e){return t*e}),1)%1e3},B=G,V=(n(101),function(t){function e(){return Object(c.a)(this,e),Object(l.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return o.a.createElement(B,null)}}]),e}(o.a.Component));i.a.render(o.a.createElement(V,null),document.getElementById("root"))},26:function(t,e,n){t.exports=n.p+"static/media/C3_mid_long_44.1k.07d4d97c.mp3"},45:function(t,e,n){t.exports=n.p+"static/media/C2_low_short_44.1k.9d4cbcaa.mp3"},47:function(t,e,n){t.exports=n(102)},52:function(t,e,n){},82:function(t,e){}},[[47,1,2]]]);
//# sourceMappingURL=main.1d66e753.chunk.js.map